---
layout: single
title: CORS
tags: [Web server]
categories: HTTP/network
---

<br/>

웹 개발을 하다 보면, 높은 확률로 아래와 같은 에러를 만나는 경험을 하게 될 수 있다.

![001](/images/2022-12-08-cors/001.png)

이 에러가 바로 **CORS 에러**로, **CORS 정책을 위반**했을 때 발생하는 에러이다.<br/>

웹에서 다른 출처로의 리소스 요청 제한과 관련된 정책으로 **`CORS`**, **`SOP`** 두 가지가 존재한다. 이 두 가지 정책과 CORS 에러에 대해 살펴보자.

<br/>

## 👉 출처(Origin)

![002](/images/2022-12-08-cors/002.png)

출처는 URL에서 **프로토콜, 호스트, 포트**로 조합된 부분을 의미한다. 셋 중 **하나라도 다르면 동일한 출처로 보지 않는다.**

- 브라우저의 콘솔 창에 `location.origin`을 실행하면 출처를 확인할 수 있다.

<br/>

### ▶️ 동일 출처, 교차 출처

- `https://www.example.com:443/dir`, `http://www.example.com:443/dir`<br/>
  ↳ **프로토콜**이 다르기 때문에 **교차 출처**이다.
- `https://www.example.com:443/dir`, `https://www.otherexample.com:443/dir`<br/>
  ↳ **호스트**가 다르기 때문에 **교차 출처**이다.
- `https://www.example.com:443/dir`, `https://www.example.com:443/dir2`<br/>
  ↳ 경로만 다르기 때문에 **동일 출처**이다.
- `https://www.example.com:443/dir`, `https://www.example.com:443/dir/inner`<br/>
  ↳ 경로만 다르기 때문에 **동일 출처**이다.
- `https://www.example.com:443/dir`, `https://www.example.com:80/dir`<br/>
  ↳ **포트**가 다르기 때문에 **교차 출처**이다.
- `https://www.example.com:443/dir`, `https://www.example.com/dir`<br/>
  ↳ **동일 출처**이다. (`https` 프로토콜의 기본 포트는 `443`)

<br/>

## 👉 동일 출처 정책 (Same-Origin Policy, SOP)

> **SOP**란 **Same-Origin-Policy**의 줄임말로, **동일 출처 정책**을 뜻한다.

**동일 출처 정책(same-origin policy)**은 어떤 출처에서 불러온 문서나 스크립트가 다른 출처에서 가져온 리소스와 상호작용하는 것을 제한하는 보안 방식이다.<br/>

한마디로 **"같은 출처의 리소스만 공유가 가능하다"**라는 정책이다.  <br/>





<br/>

### ▶️ SOP은 왜 생겨나게 되었을까?

동일 출처 정책은 잠재적으로 해로울 수 있는 문서를 분리함으로써 **공격받을 수 있는 경로를 줄여준다.** <br/>

SOP을 통해 해킹 등의 위협에서 보다 더 안전해질 수 있다는 것이다.





## Reference

[[Browser] CORS란?](https://beomy.github.io/tech/browser/cors/)

[MDN : 동일 출처 정책](https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy)

[Understanding "same-site" and "same-origin"](https://web.dev/i18n/en/same-site-same-origin/)

[CORS는 왜 이렇게 우리를 힘들게 하는걸까?](https://evan-moon.github.io/2020/05/21/about-cors/)